<VirtualHost *:80>
    ServerName attack.voyager.id.vn

    # Proxy
    ProxyPreserveHost On
    ProxyPass        / http://127.0.0.1:5000/
    ProxyPassReverse / http://127.0.0.1:5000/
    
RewriteEngine on
RewriteCond %{SERVER_NAME} =attack.voyager.id.vn
RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [END,NE,R=permanent]
</VirtualHost>

<VirtualHost *:443>
    ServerName attack.voyager.id.vn

    # Proxy
    ProxyPreserveHost On
    ProxyPass        / http://127.0.0.1:5000/
    ProxyPassReverse / http://127.0.0.1:5000/
   
    #SSL
    SSLEngine on

    DocumentRoot /var/www/html
    Include /etc/letsencrypt/options-ssl-apache.conf
    SSLCertificateFile /etc/letsencrypt/live/attack.voyager.id.vn/fullchain.pem
SSLCertificateKeyFile /etc/letsencrypt/live/attack.voyager.id.vn/privkey.pem
</VirtualHost>

<VirtualHost *:80>
    ServerName listener.voyager.id.vn

    # Proxy
    ProxyPreserveHost On
    ProxyPass        / http://127.0.0.1:5001/
    ProxyPassReverse / http://127.0.0.1:5001/
    
    SSLEngine on

    # ModSecurity AuditLog
    SecRuleEngine On
    SecRequestBodyAccess On
    SecAuditEngine On
    SecAuditLog /var/log/apache2/listen.log
    SecAuditLogParts ABCFZ
    SecAuditLogType Serial

    # Limits
    SecRequestBodyLimit 13107200
    SecRequestBodyNoFilesLimit 131072
    SecRequestBodyInMemoryLimit 131072
    SSLCertificateFile /etc/letsencrypt/live/listener.voyager.id.vn/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/listener.voyager.id.vn/privkey.pem
Include /etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>

<VirtualHost *:443>
    ServerName listener.voyager.id.vn

    # Proxy
    ProxyPreserveHost On
    ProxyPass        / http://127.0.0.1:5001/
    ProxyPassReverse / http://127.0.0.1:5001/

    SSLEngine on

    # ModSecurity AuditLog
    SecRuleEngine On
    SecRequestBodyAccess On
    SecAuditEngine On
    SecAuditLog /var/log/apache2/listen.log
    SecAuditLogParts ABCFZ
    SecAuditLogType Serial

    # Limits
    SecRequestBodyLimit 13107200
    SecRequestBodyNoFilesLimit 131072
    SecRequestBodyInMemoryLimit 131072
    SSLCertificateFile /etc/letsencrypt/live/listener.voyager.id.vn/fullchain.pem
    SSLCertificateKeyFile /etc/letsencrypt/live/listener.voyager.id.vn/privkey.pem
Include /etc/letsencrypt/options-ssl-apache.conf
</VirtualHost>